<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>滚木：巴巴博一</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🎮</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap">
    <link rel="stylesheet" href="css/main.css">
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>
    <!-- 加载屏幕 -->
    <div id="loading-screen" class="loading-screen">
        <div class="loader"></div>
        <div class="loading-text">加载游戏中...</div>
    </div>
    
    <!-- 主游戏容器 -->
    <div id="game-container" class="game-container">
        <!-- 主菜单 -->
        <div id="main-menu" class="screen active">
            <div class="menu-header">
                <h1><i class="fas fa-hat-wizard"></i> 石剪布4.0</h1>
                <p class="subtitle">整合版 - 联机对战 & 详细图鉴</p>
                <div class="game-version">整合版</div>
            </div>
            
            <div class="menu-options">
                <button id="start-game" class="menu-btn">
                    <i class="fas fa-play"></i> 单人游戏
                </button>
                <button id="multiplayer-game" class="menu-btn">
                    <i class="fas fa-users"></i> 多人联机
                </button>
                <button id="rogue-mode" class="menu-btn">
                    <i class="fas fa-dungeon"></i> 肉鸽模式
                </button>
                <button id="encyclopedia" class="menu-btn">
                    <i class="fas fa-book"></i> 游戏图鉴
                </button>
                <button id="how-to-play" class="menu-btn">
                    <i class="fas fa-question-circle"></i> 游戏教程
                </button>
                <button id="ranked-game" class="menu-btn">
                    <i class="fas fa-trophy"></i> 排位赛
                </button>
                <button id="achievement-btn" class="menu-btn">
                    <i class="fas fa-award"></i> 成就系统
                </button>
                <button id="account-btn" class="menu-btn">
                    <i class="fas fa-user-circle"></i> 账号中心
                </button>
                <button id="settings" class="menu-btn">
                    <i class="fas fa-cog"></i> 游戏设置
                </button>
                <button id="exit-game" class="menu-btn">
                    <i class="fas fa-sign-out-alt"></i> 退出游戏
                </button>
            </div>
            
            <div class="music-control">
                <button id="toggle-music" class="music-btn">
                    <i class="fas fa-volume-up"></i> <span id="music-status">音乐: 开</span>
                </button>
                <button id="toggle-sfx" class="music-btn">
                    <i class="fas fa-volume-mute"></i> <span id="sfx-status">音效: 开</span>
                </button>
            </div>
            
            <div class="game-stats">
                <div class="stat-item">
                    <i class="fas fa-users"></i> 支持2-6人游戏
                </div>
                <div class="stat-item">
                    <i class="fas fa-cards"></i> 182种道具
                </div>
                <div class="stat-item">
                    <i class="fas fa-hat-wizard"></i> 19种职业
                </div>
                <div class="stat-item">
                    <i class="fas fa-wifi"></i> 联机对战
                </div>
            </div>
            
            <div class="version">版本: Beta 0.03 | 开发者: 道具大战团队</div>
        </div>

        <!-- 多人联机界面 -->
        <div id="multiplayer-screen" class="screen">
            <div class="multiplayer-header">
                <h2><i class="fas fa-users"></i> 多人联机对战</h2>
                <p class="subtitle">与朋友一起游玩，或者加入随机房间</p>
            </div>
            
            <div class="multiplayer-content">
                <div class="multiplayer-section">
                    <h3><i class="fas fa-plus-circle"></i> 创建房间</h3>
                    <div class="form-group">
                        <label for="player-name">你的昵称</label>
                        <input type="text" id="player-name" class="form-control" placeholder="输入昵称" maxlength="20" value="玩家">
                    </div>
                    <div class="form-group">
                        <label for="room-name">房间名称</label>
                        <input type="text" id="room-name" class="form-control" placeholder="输入房间名称" maxlength="30" value="道具大战房间">
                    </div>
                    <div class="form-group">
                        <label for="room-password">房间密码 (可选)</label>
                        <input type="text" id="room-password" class="form-control" placeholder="输入密码 (留空为公开房间)">
                    </div>
                    <div class="form-group">
                        <label for="max-players">最大玩家数</label>
                        <select id="max-players" class="form-control">
                            <option value="2">2人</option>
                            <option value="3">3人</option>
                            <option value="4" selected>4人</option>
                            <option value="5">5人</option>
                            <option value="6">6人</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="ai-count">AI数量</label>
                        <select id="ai-count" class="form-control">
                            <option value="0">0个 (纯真人)</option>
                            <option value="1">1个</option>
                            <option value="2">2个</option>
                            <option value="3">3个</option>
                            <option value="4">4个</option>
                            <option value="5">5个</option>
                        </select>
                    </div>
                    <button id="create-room" class="menu-btn">
                        <i class="fas fa-gamepad"></i> 创建房间
                    </button>
                </div>
                
                <div class="multiplayer-section">
                    <h3><i class="fas fa-door-open"></i> 加入房间</h3>
                    <div class="form-group">
                        <label for="join-player-name">你的昵称</label>
                        <input type="text" id="join-player-name" class="form-control" placeholder="输入昵称" maxlength="20" value="玩家">
                    </div>
                    <div class="form-group">
                        <label for="room-id">房间ID</label>
                        <input type="text" id="room-id" class="form-control" placeholder="输入房间ID">
                    </div>
                    <div class="form-group">
                        <label for="join-room-password">房间密码 (如果有)</label>
                        <input type="text" id="join-room-password" class="form-control" placeholder="输入密码">
                    </div>
                    <button id="join-room" class="menu-btn">
                        <i class="fas fa-sign-in-alt"></i> 加入房间
                    </button>
                    
                    <div class="form-group">
                        <label>公共房间列表</label>
                        <div id="public-rooms" class="room-list">
                            <!-- 房间列表会动态添加到这里 -->
                            <div class="room-empty">
                                <p style="text-align: center; color: #a5b1c2; padding: 20px;">正在加载房间列表...</p>
                            </div>
                        </div>
                        <button id="refresh-rooms" class="small-btn">
                            <i class="fas fa-sync-alt"></i> 刷新列表
                        </button>
                    </div>
                </div>
                
                <div class="multiplayer-section">
                    <h3><i class="fas fa-comments"></i> 房间聊天</h3>
                    <div class="chat-container">
                        <div id="room-chat-messages" class="chat-messages">
                            <div class="chat-message system">
                                <strong>系统:</strong> 欢迎来到道具大战联机对战！
                            </div>
                        </div>
                        <div class="chat-input-group">
                            <input type="text" id="chat-input" class="chat-input" placeholder="输入消息..." maxlength="200">
                            <button id="send-chat" class="small-btn">发送</button>
                        </div>
                    </div>
                    
                    <div class="player-list">
                        <h4><i class="fas fa-user-friends"></i> 房间玩家</h4>
                        <div id="room-players" class="player-list-items">
                            <div class="player-list-item">
                                <div class="player-avatar-small">👤</div>
                                <span>等待玩家加入...</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 20px;">
                        <button id="start-multiplayer-game" class="menu-btn" disabled>
                            <i class="fas fa-play"></i> 开始游戏
                        </button>
                        <button id="leave-room" class="small-btn" style="background: rgba(231, 76, 60, 0.2); color: #e74c3c;">
                            <i class="fas fa-sign-out-alt"></i> 离开房间
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="class-actions" style="margin-top: 30px;">
                <button id="back-from-multiplayer" class="back-btn">
                    <i class="fas fa-arrow-left"></i> 返回主菜单
                </button>
            </div>
        </div>

        <!-- 图鉴界面 -->
        <div id="encyclopedia-screen" class="screen">
            <div class="encyclopedia-header">
                <h2><i class="fas fa-book-open"></i> 游戏图鉴</h2>
                <p class="subtitle">了解所有职业和道具的详细信息</p>
            </div>
            
            <div class="encyclopedia-tabs">
                <button class="encyclopedia-tab active" data-tab="classes">职业图鉴</button>
                <button class="encyclopedia-tab" data-tab="items">道具图鉴</button>
                <button class="encyclopedia-tab" data-tab="cards">卡牌图鉴</button>
                <button class="encyclopedia-tab" data-tab="strategies">新手攻略</button>
            </div>
            
            <!-- 职业图鉴 -->
            <div id="encyclopedia-classes" class="encyclopedia-content active">
                <div class="encyclopedia-filters">
                    <button class="filter-btn active" data-filter="all">全部职业</button>
                    <button class="filter-btn" data-filter="easy">简单</button>
                    <button class="filter-btn" data-filter="medium">中等</button>
                    <button class="filter-btn" data-filter="hard">困难</button>
                    <button class="filter-btn" data-filter="very_hard">极难</button>
                </div>
                
                <div id="classes-grid" class="encyclopedia-grid">
                    <!-- 职业卡片会动态添加到这里 -->
                </div>
            </div>
            
            <!-- 道具图鉴 -->
            <div id="encyclopedia-items" class="encyclopedia-content">
                <div class="encyclopedia-filters">
                    <button class="filter-btn active" data-filter="all">全部道具</button>
                    <button class="filter-btn" data-filter="attack">攻击类</button>
                    <button class="filter-btn" data-filter="defense">防御类</button>
                    <button class="filter-btn" data-filter="special">特殊类</button>
                    <button class="filter-btn" data-filter="epic">史诗道具</button>
                </div>
                
                <div id="items-grid" class="encyclopedia-grid">
                    <!-- 道具卡片会动态添加到这里 -->
                </div>
            </div>
            
            <!-- 卡牌图鉴 -->
            <div id="encyclopedia-cards" class="encyclopedia-content">
                <div class="encyclopedia-filters">
                    <button class="filter-btn active" data-filter="all">全部卡牌</button>
                    <button class="filter-btn" data-filter="common">普通</button>
                    <button class="filter-btn" data-filter="uncommon">精良</button>
                    <button class="filter-btn" data-filter="rare">稀有</button>
                    <button class="filter-btn" data-filter="epic">史诗</button>
                </div>
                
                <div id="cards-grid" class="encyclopedia-grid">
                    <!-- 卡牌卡片会动态添加到这里 -->
                </div>
            </div>
            
            <!-- 新手攻略 -->
            <div id="encyclopedia-strategies" class="encyclopedia-content">
                <div class="encyclopedia-card" style="max-width: 800px; margin: 0 auto;">
                    <div class="encyclopedia-card-header">
                        <div class="encyclopedia-icon" style="background: linear-gradient(45deg, #3498db, #2980b9);">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <div>
                            <div class="encyclopedia-card-title">新手入门指南</div>
                            <div class="encyclopedia-card-subtitle">快速上手道具大战</div>
                        </div>
                    </div>
                    
                    <div class="encyclopedia-card-body">
                        <h3 style="margin: 15px 0 10px; color: #4ecdc4;">游戏目标</h3>
                        <p>成为最后存活的玩家！通过使用道具卡和职业能力击败其他玩家。</p>
                        
                        <h3 style="margin: 15px 0 10px; color: #4ecdc4;">基本流程</h3>
                        <ol style="margin-left: 20px; margin-bottom: 15px;">
                            <li><strong>选择职业</strong>: 每个职业有独特能力和玩法</li>
                            <li><strong>发牌阶段</strong>: 每位玩家获得初始手牌</li>
                            <li><strong>回合开始</strong>: 按顺序进行回合</li>
                            <li><strong>出牌阶段</strong>: 使用道具卡或跳过</li>
                            <li><strong>回合结束</strong>: 切换下一个玩家</li>
                        </ol>
                        
                        <h3 style="margin: 15px 0 10px; color: #4ecdc4;">道具卡类型</h3>
                        <ul style="margin-left: 20px; margin-bottom: 15px;">
                            <li><strong style="color: #e74c3c;">攻击类</strong>: 弃置其他玩家手牌，如"杀人诛心"</li>
                            <li><strong style="color: #3498db;">防御类</strong>: 保护自己免受攻击，如"白旗"</li>
                            <li><strong style="color: #f1c40f;">特殊类</strong>: 改变游戏规则或局势，如"互换"</li>
                            <li><strong style="color: #9b59b6;">稀有卡</strong>: 效果强大的稀有道具，如"毒药"</li>
                        </ul>
                        
                        <h3 style="margin: 15px 0 10px; color: #4ecdc4;">职业推荐</h3>
                        <p><strong>新手推荐:</strong> 士兵、商人、天使（操作简单，容易上手）</p>
                        <p><strong>进阶挑战:</strong> 炼金术师、魔术师、乐子人（策略性强，操作复杂）</p>
                        
                        <h3 style="margin: 15px 0 10px; color: #4ecdc4;">核心策略</h3>
                        <ul style="margin-left: 20px; margin-bottom: 15px;">
                            <li>保持手牌数量，避免被淘汰</li>
                            <li>观察对手职业，针对性出牌</li>
                            <li>合理使用防御卡，保护关键手牌</li>
                            <li>在合适时机使用稀有卡，扭转战局</li>
                            <li>了解职业特性，发挥最大优势</li>
                        </ul>
                        
                        <div class="encyclopedia-card-tags">
                            <span class="encyclopedia-tag">新手教程</span>
                            <span class="encyclopedia-tag">游戏策略</span>
                            <span class="encyclopedia-tag">入门指南</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="class-actions" style="margin-top: 30px;">
                <button id="back-from-encyclopedia" class="back-btn">
                    <i class="fas fa-arrow-left"></i> 返回主菜单
                </button>
            </div>
        </div>

        <!-- 职业选择界面 -->
        <div id="class-selection-screen" class="screen">
            <div class="class-header">
                <h2><i class="fas fa-crown"></i> 选择你的职业</h2>
                <p class="subtitle">每个职业都有独特的能力和玩法</p>
            </div>
            
            <div class="class-grid" id="class-grid">
                <!-- 职业卡片会动态添加到这里 -->
            </div>
            
            <div class="class-actions">
                <button id="back-from-class" class="back-btn">
                    <i class="fas fa-arrow-left"></i> 返回
                </button>
                <button id="confirm-class" class="menu-btn" disabled>
                    <i class="fas fa-check"></i> 确认选择
                </button>
            </div>
        </div>

        <!-- 游戏设置 -->
        <div id="settings-screen" class="screen">
            <div class="settings-header">
                <h2><i class="fas fa-cog"></i> 游戏设置</h2>
                <button id="back-to-menu" class="back-btn">
                    <i class="fas fa-arrow-left"></i> 返回主菜单
                </button>
            </div>
            
            <div class="settings-content">
                <div class="setting-group">
                    <h3><i class="fas fa-users"></i> 游戏设置</h3>
                    <div class="setting-item">
                        <label><i class="fas fa-user-friends"></i> 玩家数量:</label>
                        <select id="player-count">
                            <option value="2">2人</option>
                            <option value="3">3人</option>
                            <option value="4" selected>4人</option>
                            <option value="5">5人</option>
                            <option value="6">6人</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label><i class="fas fa-robot"></i> AI难度:</label>
                        <select id="ai-difficulty">
                            <option value="easy">简单</option>
                            <option value="medium" selected>中等</option>
                            <option value="hard">困难</option>
                            <option value="expert">专家</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label><i class="fas fa-layer-group"></i> 初始手牌:</label>
                        <input type="range" id="initial-cards" min="5" max="30" value="15">
                        <span id="initial-cards-value">15张</span>
                    </div>
                </div>
                
                <div class="setting-group">
                    <h3><i class="fas fa-book"></i> 游戏规则说明</h3>
                    <div class="setting-item" style="flex-direction: column; align-items: flex-start; gap: 5px;">
                        <p style="color: #a5b1c2; font-size: 0.9rem; line-height: 1.5;">
                            <strong>胜利条件:</strong> 成为最后存活的玩家或队伍<br>
                            <strong>失败条件:</strong> 手牌为0时被淘汰<br>
                            <strong>游戏流程:</strong> 1.选择职业 2.发牌阶段 3.扣置阶段 4.出牌阶段 5.回合结束 6.休息阶段<br>
                            <strong>特殊规则:</strong> 部分职业有特殊能力，道具卡有不同效果<br>
                            <strong>道具类型:</strong> 攻击、防御、特殊、稀有四种类型<br>
                            <strong>职业系统:</strong> 每个职业有独特的主动和被动技能
                        </p>
                    </div>
                </div>
                
                <div class="setting-group">
                    <h3><i class="fas fa-gamepad"></i> 娱乐模式</h3>
                    <div class="setting-item">
                        <label><i class="fas fa-hat-wizard"></i> 娱乐模式:</label>
                        <select id="entertainment-mode">
                            <option value="none">无</option>
                            <option value="reincarnation">再次投胎</option>
                            <option value="forced-balance">强行制衡</option>
                            <option value="open-cards">明牌模式</option>
                            <option value="team-play">组队模式</option>
                            <option value="enhanced-skills">增强技能</option>
                        </select>
                    </div>
                    <div class="setting-item" style="flex-direction: column; align-items: flex-start; gap: 5px;">
                        <p style="color: #a5b1c2; font-size: 0.9rem; line-height: 1.5;">
                            <strong>再次投胎:</strong> 所有死亡玩家复活并打乱职业，固定6张牌<br>
                            <strong>强行制衡:</strong> 所有玩家必须弃掉所有牌，并重新分配<br>
                            <strong>明牌模式:</strong> 所有人强行明牌<br>
                            <strong>组队模式:</strong> 联合组队3v3或4v4<br>
                            <strong>增强技能:</strong> 全员技能大幅增强，每回合固定扣两张牌
                        </p>
                    </div>
                </div>
                
                <div class="setting-group">
                    <h3><i class="fas fa-sliders-h"></i> 显示设置</h3>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="show-animations" checked> 显示动画效果
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="card-hints" checked> 显示卡片提示
                        </label>
                    </div>
                    <div class="setting-item">
                        <label><i class="fas fa-expand-alt"></i> UI缩放:</label>
                        <input type="range" id="ui-scale" min="80" max="120" value="100">
                        <span id="ui-scale-value">100%</span>
                    </div>
                </div>
                
                <div class="setting-group">
                    <h3><i class="fas fa-user"></i> 个人设置</h3>
                    <div class="setting-item">
                        <label><i class="fas fa-user-circle"></i> 选择头像:</label>
                        <div class="avatar-selection">
                            <div class="avatar-options">
                                <div class="avatar-option" data-avatar="👤" title="默认头像"></div>
                                <div class="avatar-option" data-avatar="👨" title="男性头像"></div>
                                <div class="avatar-option" data-avatar="👩" title="女性头像"></div>
                                <div class="avatar-option" data-avatar="🧙" title="魔法师"></div>
                                <div class="avatar-option" data-avatar="🦹" title="超级反派"></div>
                                <div class="avatar-option" data-avatar="🧚" title="精灵"></div>
                                <div class="avatar-option" data-avatar="🧛" title="吸血鬼"></div>
                                <div class="avatar-option" data-avatar="🧜" title="人鱼"></div>
                                <div class="avatar-option" data-avatar="🧝" title="矮人"></div>
                                <div class="avatar-option" data-avatar="👻" title="幽灵"></div>
                                <div class="avatar-option" data-avatar="🤖" title="机器人"></div>
                                <div class="avatar-option" data-avatar="🐱" title="猫咪"></div>
                                <div class="avatar-option" data-avatar="🐶" title="狗狗"></div>
                                <div class="avatar-option" data-avatar="🐼" title="熊猫"></div>
                                <div class="avatar-option" data-avatar="🐨" title="考拉"></div>
                            </div>
                            <div class="selected-avatar">
                                <span id="current-avatar">👤</span>
                                <span>当前选择</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="setting-group">
                    <h3><i class="fas fa-volume-up"></i> 声音设置</h3>
                    <div class="setting-item">
                        <label><i class="fas fa-music"></i> 背景音乐:</label>
                        <input type="range" id="music-volume" min="0" max="100" value="70">
                        <span id="music-volume-value">70%</span>
                    </div>
                    <div class="setting-item">
                        <label><i class="fas fa-gamepad"></i> 对战音乐:</label>
                        <input type="range" id="battle-music-volume" min="0" max="100" value="70">
                        <span id="battle-music-volume-value">70%</span>
                    </div>
                    <div class="setting-item">
                        <label><i class="fas fa-users"></i> 联机大厅音乐:</label>
                        <input type="range" id="lobby-music-volume" min="0" max="100" value="70">
                        <span id="lobby-music-volume-value">70%</span>
                    </div>
                    <div class="setting-item">
                        <label><i class="fas fa-volume"></i> 游戏音效:</label>
                        <input type="range" id="sfx-volume" min="0" max="100" value="80">
                        <span id="sfx-volume-value">80%</span>
                    </div>
                </div>
                
                <div class="setting-actions">
                    <button id="save-settings" class="save-btn">
                        <i class="fas fa-save"></i> 保存设置
                    </button>
                    <button id="reset-settings" class="reset-btn">
                        <i class="fas fa-undo"></i> 恢复默认
                    </button>
                </div>
            </div>
        </div>

        <!-- 账号系统界面 -->
        <div id="account-screen" class="screen">
            <div class="account-header">
                <h2><i class="fas fa-user-circle"></i> 账号中心</h2>
                <button id="back-from-account" class="back-btn">
                    <i class="fas fa-arrow-left"></i> 返回
                </button>
            </div>
            
            <div class="account-content">
                <div class="account-tabs">
                    <button class="account-tab active" data-tab="login">登录</button>
                    <button class="account-tab" data-tab="register">注册</button>
                </div>
                
                <div id="login-form" class="account-form active">
                    <div class="form-group">
                        <label for="login-email"><i class="fas fa-envelope"></i> 邮箱</label>
                        <input type="email" id="login-email" class="form-control" placeholder="请输入邮箱">
                    </div>
                    <div class="form-group">
                        <label for="login-password"><i class="fas fa-lock"></i> 密码</label>
                        <input type="password" id="login-password" class="form-control" placeholder="请输入密码">
                    </div>
                    <button id="login-submit" class="menu-btn">
                        <i class="fas fa-sign-in-alt"></i> 登录
                    </button>
                    <div class="third-party-login">
                        <p>其他登录方式</p>
                        <div class="third-party-btns">
                            <button class="third-party-btn" data-platform="wechat" title="微信登录">
                                <i class="fab fa-weixin"></i>
                            </button>
                            <button class="third-party-btn" data-platform="qq" title="QQ登录">
                                <i class="fab fa-qq"></i>
                            </button>
                            <button class="third-party-btn" data-platform="weibo" title="微博登录">
                                <i class="fab fa-weibo"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="register-form" class="account-form">
                    <div class="form-group">
                        <label for="register-email"><i class="fas fa-envelope"></i> 邮箱</label>
                        <input type="email" id="register-email" class="form-control" placeholder="请输入邮箱">
                    </div>
                    <div class="form-group">
                        <label for="register-password"><i class="fas fa-lock"></i> 密码</label>
                        <input type="password" id="register-password" class="form-control" placeholder="请输入密码">
                    </div>
                    <div class="form-group">
                        <label for="register-confirm"><i class="fas fa-lock"></i> 确认密码</label>
                        <input type="password" id="register-confirm" class="form-control" placeholder="请再次输入密码">
                    </div>
                    <div class="form-group">
                        <label for="register-nickname"><i class="fas fa-user"></i> 昵称</label>
                        <input type="text" id="register-nickname" class="form-control" placeholder="请输入昵称" maxlength="20">
                    </div>
                    <button id="register-submit" class="menu-btn">
                        <i class="fas fa-user-plus"></i> 注册
                    </button>
                </div>
            </div>
            
            <div class="user-profile hidden">
                <div class="profile-header">
                    <div class="profile-avatar">
                        <span id="user-avatar">👤</span>
                    </div>
                    <div class="profile-info">
                        <h3 id="user-nickname">玩家</h3>
                        <p id="user-email">user@example.com</p>
                    </div>
                </div>
                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="stat-label">总场次</span>
                        <span class="stat-value" id="total-games">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">胜率</span>
                        <span class="stat-value" id="win-rate">0%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">段位</span>
                        <span class="stat-value" id="user-rank">青铜</span>
                    </div>
                </div>
                <button id="logout-btn" class="menu-btn" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">
                    <i class="fas fa-sign-out-alt"></i> 退出登录
                </button>
            </div>
        </div>

        <!-- 排位赛界面 -->
        <div id="ranked-screen" class="screen">
            <div class="ranked-header">
                <h2><i class="fas fa-trophy"></i> 排位赛</h2>
                <button id="back-from-ranked" class="back-btn">
                    <i class="fas fa-arrow-left"></i> 返回
                </button>
            </div>
            
            <div class="ranked-content">
                <div class="current-rank-section">
                    <div class="rank-badge-container">
                        <div class="rank-badge" id="rank-badge">
                            <i class="fas fa-medal"></i>
                        </div>
                    </div>
                    <div class="rank-info">
                        <span class="rank-name" id="rank-name">青铜 III</span>
                        <span class="rank-points" id="rank-points">1250 分</span>
                    </div>
                    <div class="rank-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="rank-progress-fill" style="width: 50%;"></div>
                        </div>
                        <span class="progress-text" id="rank-progress-text">距离晋级还需 250 分</span>
                    </div>
                </div>
                
                <div class="season-info">
                    <h3><i class="fas fa-calendar-alt"></i> 当前赛季</h3>
                    <p id="season-name">第1赛季</p>
                    <p id="season-time">剩余时间: 30天</p>
                </div>
                
                <div class="ranked-actions">
                    <button id="find-match" class="menu-btn">
                        <i class="fas fa-search"></i> 开始匹配
                    </button>
                    <button id="view-leaderboard" class="menu-btn">
                        <i class="fas fa-list-ol"></i> 排行榜
                    </button>
                </div>
                
                <div class="ranked-history">
                    <h3><i class="fas fa-history"></i> 最近战绩</h3>
                    <div id="match-history" class="match-history-list">
                        <div class="match-item">
                            <span class="match-result win">胜</span>
                            <span class="match-info">排位赛 - 第1名</span>
                            <span class="match-points">+25分</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 成就系统界面 -->
        <div id="achievement-screen" class="screen">
            <div class="achievement-header">
                <h2><i class="fas fa-award"></i> 成就系统</h2>
                <button id="back-from-achievement" class="back-btn">
                    <i class="fas fa-arrow-left"></i> 返回
                </button>
            </div>
            
            <div class="achievement-content">
                <div class="achievement-stats">
                    <div class="achievement-stat">
                        <span class="stat-number" id="unlocked-count">0</span>
                        <span class="stat-label">已解锁</span>
                    </div>
                    <div class="achievement-stat">
                        <span class="stat-number" id="total-achievements">50</span>
                        <span class="stat-label">总成就</span>
                    </div>
                    <div class="achievement-stat">
                        <span class="stat-number" id="achievement-points">0</span>
                        <span class="stat-label">成就点数</span>
                    </div>
                </div>
                
                <div class="achievement-tabs">
                    <button class="achievement-tab active" data-category="all">全部</button>
                    <button class="achievement-tab" data-category="game">游戏</button>
                    <button class="achievement-tab" data-category="class">职业</button>
                    <button class="achievement-tab" data-category="social">社交</button>
                </div>
                
                <div id="achievement-list" class="achievement-list">
                    <div class="achievement-item locked">
                        <div class="achievement-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="achievement-info">
                            <h4>初次胜利</h4>
                            <p>赢得第一场游戏</p>
                        </div>
                        <div class="achievement-status">
                            <i class="fas fa-lock"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 教程界面 -->
        <div id="tutorial-screen" class="screen">
            <div class="tutorial-header">
                <h2><i class="fas fa-graduation-cap"></i> 游戏教程</h2>
                <button id="back-from-tutorial" class="back-btn">
                    <i class="fas fa-arrow-left"></i> 返回
                </button>
            </div>
            
            <div class="tutorial-content">
                <div class="tutorial-section">
                    <h3><i class="fas fa-trophy"></i> 游戏目标</h3>
                    <p>成为最后存活的玩家！通过使用道具卡和职业能力击败其他玩家。</p>
                </div>
                
                <div class="tutorial-section">
                    <h3><i class="fas fa-list-ol"></i> 基本流程</h3>
                    <ol>
                        <li><strong>发牌阶段</strong>: 每位玩家获得初始手牌</li>
                        <li><strong>回合开始</strong>: 按顺序进行回合</li>
                        <li><strong>出牌阶段</strong>: 使用道具卡或跳过</li>
                        <li><strong>回合结束</strong>: 切换下一个玩家</li>
                    </ol>
                </div>
                
                <div class="tutorial-section">
                    <h3><i class="fas fa-cards"></i> 道具卡类型</h3>
                    <ul>
                        <li><strong>攻击类</strong>: 弃置其他玩家手牌</li>
                        <li><strong>防御类</strong>: 保护自己免受攻击</li>
                        <li><strong>特殊类</strong>: 改变游戏规则或局势</li>
                        <li><strong>稀有卡</strong>: 效果强大的稀有道具</li>
                    </ul>
                </div>
                
                <div class="tutorial-section">
                    <h3><i class="fas fa-gamepad"></i> 如何操作</h3>
                    <ul>
                        <li><strong>点击卡牌</strong>: 选择卡牌进行使用</li>
                        <li><strong>选择目标</strong>: 有些卡牌需要选择其他玩家作为目标</li>
                        <li><strong>结束回合</strong>: 完成当前回合行动</li>
                        <li><strong>跳过</strong>: 本回合不进行任何行动</li>
                    </ul>
                </div>
                
                <div class="tutorial-section">
                    <h3><i class="fas fa-victory-hand"></i> 胜利条件</h3>
                    <p>击败所有其他玩家，成为最后的幸存者！</p>
                </div>
                
                <div class="tutorial-section">
                    <h3><i class="fas fa-skull-crossbones"></i> 失败条件</h3>
                    <p>手牌数为0时将被淘汰出局！</p>
                </div>
                
                <div class="tutorial-section">
                    <h3><i class="fas fa-users"></i> 多人联机</h3>
                    <p>与朋友一起游玩：</p>
                    <ol>
                        <li>创建房间或加入房间</li>
                        <li>等待所有玩家准备就绪</li>
                        <li>房主开始游戏</li>
                        <li>实时同步游戏状态</li>
                        <li>使用聊天功能交流</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- 主游戏界面 -->
        <div id="game-screen" class="screen">
            <!-- 顶部信息栏 -->
            <div class="game-header">
                <div class="game-info">
                    <div class="info-item">
                        <i class="fas fa-user-clock"></i>
                        <span id="current-turn">回合: 玩家1</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-layer-group"></i>
                        <span id="phase-indicator">阶段: 出牌阶段</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-hourglass-half"></i>
                        <span id="timer">时间: 30s</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-users"></i>
                        <span id="alive-count">存活: 4/4</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-skull-crossbones"></i>
                        <span id="death-period-status">死亡期: 无</span>
                    </div>
                    <div class="info-item" id="connection-status" style="color: #2ecc71;">
                        <i class="fas fa-wifi"></i>
                        <span>连接正常</span>
                    </div>
                </div>
                <div class="game-controls">
                    <button id="pause-game" class="control-btn" title="暂停游戏">
                        <i class="fas fa-pause"></i>
                    </button>
                    <button id="sort-cards" class="control-btn" title="整理卡牌">
                        <i class="fas fa-sort"></i>
                    </button>
                    <button id="view-log" class="control-btn" title="查看日志">
                        <i class="fas fa-scroll"></i>
                    </button>
                    <button id="game-help" class="control-btn" title="游戏帮助">
                        <i class="fas fa-question"></i>
                    </button>
                    <button id="quit-game" class="control-btn quit-btn" title="退出游戏">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
            
            <!-- 游戏区域 -->
            <div class="game-area">
                <!-- 其他玩家区域 -->
                <div class="opponents-area">
                    <!-- AI玩家会动态添加到这里 -->
                </div>
                
                <!-- 中央区域 -->
                <div class="center-area">
                    <div class="pile-area">
                        <div class="pile" id="draw-pile" title="点击摸牌">
                            <div class="pile-icon">
                                <i class="fas fa-layer-group"></i>
                            </div>
                            <div class="pile-label">牌堆</div>
                            <div class="pile-count">0</div>
                        </div>
                        <div class="pile" id="discard-pile" title="弃牌堆">
                            <div class="pile-icon">
                                <i class="fas fa-trash"></i>
                            </div>
                            <div class="pile-label">弃牌堆</div>
                            <div class="pile-count">0</div>
                        </div>
                    </div>
                    
                    <div class="battle-area">
                        <div class="battle-header">
                            <h3><i class="fas fa-battle-net"></i> 战斗信息</h3>
                        </div>
                        <div id="battle-log" class="battle-log">
                            <div class="battle-message">游戏开始！</div>
                        </div>
                    </div>
                </div>
                
                <!-- 玩家区域 -->
                <div class="player-area">
                    <div class="player-info">
                        <div class="player-avatar">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="player-stats">
                            <div class="player-name" id="player-display-name">玩家1</div>
                            <div class="player-class">职业: 未选择</div>
                            <div class="player-health">
                                <i class="fas fa-cards"></i> 手牌: <span id="hand-count">0</span>
                            </div>
                            <div class="player-status">状态: 正常</div>
                        </div>
                    </div>
                    
                    <!-- 玩家手牌区域 -->
                    <div class="hand-area">
                        <div class="hand-header">
                            <h4><i class="fas fa-hand-holding"></i> 你的手牌</h4>
                            <div class="hand-count">0张</div>
                        </div>
                        <div class="cards-container">
                            <!-- 手牌会动态添加到这里 -->
                        </div>
                    </div>
                    
                    <!-- 玩家操作区域 -->
                    <div class="action-area">
                        <button id="end-turn" class="action-btn end-turn-btn" disabled>
                            <i class="fas fa-hourglass-end"></i> 结束回合
                        </button>
                        <button id="pass" class="action-btn pass-btn" disabled>
                            <i class="fas fa-forward"></i> 跳过
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- 游戏日志 -->
            <div id="game-log" class="game-log">
                <div class="log-header">
                    <h3><i class="fas fa-history"></i> 游戏日志</h3>
                    <div class="log-controls">
                        <button id="clear-log" class="small-btn">清空</button>
                        <button id="toggle-log" class="small-btn">隐藏</button>
                    </div>
                </div>
                <div class="log-content">
                    <!-- 日志条目会添加到这里 -->
                </div>
            </div>
        </div>

        <!-- 目标选择界面 -->
        <div id="target-selection-overlay" class="target-selection-overlay" style="display: none;">
            <div class="target-selection">
                <h3><i class="fas fa-crosshairs"></i> 选择目标</h3>
                <div id="card-effect-info" class="card-effect-info">
                    <!-- 卡牌作用介绍会动态添加到这里 -->
                </div>
                <div id="target-list" class="target-list">
                    <!-- 目标列表会动态添加到这里 -->
                </div>
                <div class="target-actions">
                    <button id="cancel-target" class="target-btn secondary">
                        <i class="fas fa-times"></i> 取消
                    </button>
                </div>
            </div>
        </div>

        <!-- 卡片详情弹出层 -->


        <!-- 暂停菜单 -->
        <div id="pause-menu" class="modal">
            <div class="modal-content pause-content">
                <h2><i class="fas fa-pause-circle"></i> 游戏暂停</h2>
                <button id="resume-game" class="menu-btn">
                    <i class="fas fa-play"></i> 继续游戏
                </button>
                <button id="restart-game" class="menu-btn">
                    <i class="fas fa-redo"></i> 重新开始
                </button>
                <button id="back-to-menu-from-game" class="menu-btn">
                    <i class="fas fa-home"></i> 返回主菜单
                </button>
                <button id="game-settings" class="menu-btn">
                    <i class="fas fa-cog"></i> 游戏设置
                </button>
            </div>
        </div>

        <!-- 胜利/失败提示 -->
        <div id="result-modal" class="modal">
            <div class="modal-content result-content">
                <div class="result-icon victory">
                    <i class="fas fa-trophy"></i>
                </div>
                <h2 id="result-title">恭喜获胜！</h2>
                <p id="result-message">你击败了所有对手！</p>
                <div class="result-actions">
                    <button id="play-again" class="result-btn">
                        <i class="fas fa-redo"></i> 再玩一次
                    </button>
                    <button id="back-to-menu-result" class="result-btn">
                        <i class="fas fa-home"></i> 返回主菜单
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 动态背景容器 -->
        <div class="dynamic-background" id="dynamic-background"></div>
        
        <!-- 肉鸽模式专属动态背景效果 -->
        <div class="rogue-dynamic-background" id="rogue-dynamic-background"></div>

        <!-- 肉鸽模式相关HTML结构 -->
        <div id="rogue-screen-main" class="screen hidden">
            <div style="text-align: center; max-width: 800px;">
                <h1 style="font-size: 5em; margin-bottom: 20px; background: linear-gradient(45deg, var(--highlight), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0 0 30px rgba(255, 71, 87, 0.5);">滚木：巴巴博一</h1>
                <p style="font-size: 1.5em; margin-bottom: 40px; color: var(--text-secondary);">基于《滚木》规则改编的单人肉鸽游戏</p>
                <div style="margin-bottom: 50px;">
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">游戏特色：</p>
                    <div style="display: flex; justify-content: center; flex-wrap: wrap; gap: 20px;">
                        <div style="padding: 15px 25px; background: rgba(255, 255, 255, 0.05); border-radius: 25px; border: 1px solid rgba(255, 255, 255, 0.1);">六大职业</div>
                        <div style="padding: 15px 25px; background: rgba(255, 255, 255, 0.05); border-radius: 25px; border: 1px solid rgba(255, 255, 255, 0.1);">丰富卡牌</div>
                        <div style="padding: 15px 25px; background: rgba(255, 255, 255, 0.05); border-radius: 25px; border: 1px solid rgba(255, 255, 255, 0.1);">随机事件</div>
                        <div style="padding: 15px 25px; background: rgba(255, 255, 255, 0.05); border-radius: 25px; border: 1px solid rgba(255, 255, 255, 0.1);">BOSS挑战</div>
                        <div style="padding: 15px 25px; background: rgba(255, 255, 255, 0.05); border-radius: 25px; border: 1px solid rgba(255, 255, 255, 0.1);">沉浸式体验</div>
                    </div>
                </div>
                <div style="display: flex; gap: 30px; justify-content: center; margin-bottom: 40px;">
                    <button class="btn" onclick="showRogueClassSelection()" style="font-size: 1.5em; padding: 20px 50px;">开始游戏</button>
                    <button class="btn" onclick="showRogueSettings()" style="font-size: 1.2em; padding: 15px 30px;">设置</button>
                    <button class="btn" onclick="showRogueAbout()" style="font-size: 1.2em; padding: 15px 30px;">关于</button>
                </div>
                <div style="display: flex; justify-content: center;">
                    <button class="btn" onclick="switchScreen('main-menu')" style="font-size: 1.1em; padding: 12px 25px;">返回主菜单</button>
                </div>
                <p style="color: rgba(255, 255, 255, 0.5); font-size: 0.9em;">版本 1.0 | 2026年2月8日</p>
            </div>
        </div>

        <div id="rogue-screen-menu" class="screen hidden">
            <h1>选择你的职业</h1>
            <p style="color:var(--text-secondary); margin-bottom: 40px; font-size: 1.2em;">每个职业都有独特的卡牌组合和玩法</p>
            <div class="class-grid">
                <div class="class-card" onclick="startRogueGame('soldier')">
                    <div>⚔️</div>
                    <h3>士兵</h3>
                    <p>杀人诛心</p>
                    <small>核心牌：杀人猪心<br>特性：高伤、通过弃牌压制敌人</small>
                </div>
                <div class="class-card" onclick="startRogueGame('alchemist')">
                    <div>⚗️</div>
                    <h3>炼金术师</h3>
                    <p>药剂大师</p>
                    <small>核心牌：毒药/解药<br>特性：叠毒、回复、额外过牌</small>
                </div>
                <div class="class-card" onclick="startRogueGame('merchant')">
                    <div>💰</div>
                    <h3>商人</h3>
                    <p>有钱能使鬼推磨</p>
                    <small>核心牌：互换/买卖<br>特性：金币流、偷取属性</small>
                </div>
                <div class="class-card" onclick="startRogueGame('mage')">
                    <div>🔮</div>
                    <h3>魔法师</h3>
                    <p>元素掌控者</p>
                    <small>核心牌：火球术/闪电链<br>特性：元素伤害、范围攻击</small>
                </div>
                <div class="class-card" onclick="startRogueGame('thief')">
                    <div>🗡️</div>
                    <h3>盗贼</h3>
                    <p>暗影大师</p>
                    <small>核心牌：潜行/背刺<br>特性：高暴击、闪避</small>
                </div>
                <div class="class-card" onclick="startRogueGame('paladin')">
                    <div>🛡️</div>
                    <h3>圣骑士</h3>
                    <p>圣光守护者</p>
                    <small>核心牌：圣光术/神圣打击<br>特性：治疗、防护、神圣伤害</small>
                </div>
                <!-- 新职业 -->
                <div class="class-card" onclick="startRogueGame('demon')">
                    <div>👹</div>
                    <h3>恶魔</h3>
                    <p>黑暗主宰</p>
                    <small>核心牌：恶魔之力/灵魂窃取<br>特性：力量堆叠、生命偷取</small>
                </div>
                <div class="class-card" onclick="startRogueGame('angel')">
                    <div>👼</div>
                    <h3>天使</h3>
                    <p>光明使者</p>
                    <small>核心牌：天使祝福/神圣光环<br>特性：治疗、护盾、神圣伤害</small>
                </div>
                <div class="class-card" onclick="startRogueGame('troll')">
                    <div>😈</div>
                    <h3>乐子人</h3>
                    <p>恶作剧大师</p>
                    <small>核心牌：乐子人嘴脸/恶作剧<br>特性：混乱、减伤、随机伤害</small>
                </div>
                <div class="class-card" onclick="startRogueGame('fool')">
                    <div>🤡</div>
                    <h3>傻子</h3>
                    <p>鲁莽战士</p>
                    <small>核心牌：鲁莽攻击/狂怒<br>特性：高血量、自残输出</small>
                </div>
                <div class="class-card" onclick="startRogueGame('terrorist')">
                    <div>💣</div>
                    <h3>恐怖分子</h3>
                    <p>自爆专家</p>
                    <small>核心牌：爆炸/自杀袭击<br>特性：高伤害、自残、控制</small>
                </div>
                <div class="class-card" onclick="startRogueGame('burner')">
                    <div>🔥</div>
                    <h3>燃烧者</h3>
                    <p>火焰大师</p>
                    <small>核心牌：地狱火/自焚<br>特性：持续伤害、火焰护盾</small>
                </div>
                <div class="class-card" onclick="startRogueGame('cultist')">
                    <div>🧙‍♂️</div>
                    <h3>异教主</h3>
                    <p>黑暗教徒</p>
                    <small>核心牌：教徒召唤/黑暗仪式<br>特性：过牌、力量堆叠、爆发</small>
                </div>
            </div>
            <div style="margin-top: 40px;">
                <button class="btn" onclick="switchScreen('main-menu')">返回主菜单</button>
            </div>
        </div>

        <div id="rogue-settings-screen" class="screen hidden">
            <h1>游戏设置</h1>
            <div style="display: flex; flex-direction: column; gap: 30px; margin: 40px 0; max-width: 500px;">
                <div>
                    <h3>音效音量</h3>
                    <input type="range" id="rogue-sound-volume" min="0" max="100" value="80" style="width: 100%; margin: 10px 0;">
                    <div style="display: flex; justify-content: space-between; font-size: 0.9em; color: var(--text-secondary);">
                        <span>静音</span>
                        <span>最大</span>
                    </div>
                </div>
                <div>
                    <h3>音乐音量</h3>
                    <input type="range" id="rogue-music-volume" min="0" max="100" value="60" style="width: 100%; margin: 10px 0;">
                    <div style="display: flex; justify-content: space-between; font-size: 0.9em; color: var(--text-secondary);">
                        <span>静音</span>
                        <span>最大</span>
                    </div>
                </div>
                <div>
                    <h3>游戏难度</h3>
                    <select id="rogue-game-difficulty" style="width: 100%; padding: 10px; background: var(--card-bg); color: var(--text-main); border: 1px solid var(--accent); border-radius: 5px; font-size: 1em;">
                        <option value="easy">简单</option>
                        <option value="normal" selected>普通</option>
                        <option value="hard">困难</option>
                        <option value="nightmare">噩梦</option>
                    </select>
                </div>
                <div>
                    <h3>游戏速度</h3>
                    <select id="rogue-game-speed" style="width: 100%; padding: 10px; background: var(--card-bg); color: var(--text-main); border: 1px solid var(--accent); border-radius: 5px; font-size: 1em;">
                        <option value="slow">慢速</option>
                        <option value="normal" selected>正常</option>
                        <option value="fast">快速</option>
                    </select>
                </div>
            </div>
            <button class="btn" onclick="saveRogueSettings()">保存设置</button>
            <button class="btn" onclick="switchScreen('rogue-screen-main')">返回</button>
        </div>

        <div id="rogue-about-screen" class="screen hidden">
            <h1>关于游戏</h1>
            <div style="max-width: 600px; text-align: center; margin: 40px 0;">
                <p style="margin-bottom: 20px; color: var(--text-secondary);">滚木：巴巴博一 v1.0</p>
                <p style="margin-bottom: 20px; color: var(--text-secondary);">基于《滚木》规则改编的单人肉鸽游戏</p>
                <p style="margin-bottom: 20px; color: var(--text-secondary);">游戏特色：</p>
                <ul style="list-style: none; padding: 0; margin: 20px 0; color: var(--text-secondary);">
                    <li>• 六大职业，各具特色</li>
                    <li>• 丰富的卡牌系统</li>
                    <li>• 随机生成的地图和事件</li>
                    <li>• 紧张刺激的BOSS战</li>
                    <li>• 现代化的视觉效果</li>
                    <li>• 沉浸式的音效系统</li>
                </ul>
                <p style="margin-top: 30px; color: var(--text-secondary);">© 2024 滚木开发团队</p>
            </div>
            <button class="btn" onclick="switchScreen('rogue-screen-main')">返回</button>
        </div>

        <div id="rogue-map-screen" class="screen hidden">
            <h2>选择前进路径</h2>
            <div style="text-align: center; margin-bottom: 20px; padding: 15px; background: rgba(50, 50, 100, 0.3); border-radius: 10px; border: 1px solid rgba(100, 150, 255, 0.3);">
                <h3 style="margin-bottom: 10px; color: var(--gold);">当前楼层: <span id="current-floor-display">1</span></h3>
                <p id="floor-enemies-info" style="color: var(--text-secondary); font-size: 0.9em;">本楼层可能出现的敌人: 迷途赌徒、暴躁老哥、偷牌贼</p>
            </div>
            <div id="rogue-room-grid" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 20px; margin: 30px 0;"></div>
            <div style="display: flex; gap: 20px; justify-content: center; margin-top: 30px;">
                <button class="btn" onclick="enterRogueSelectedRoom()">进入房间</button>
                <button class="btn" onclick="rogueSkipFloor()">跳关</button>
                <button class="btn" onclick="leaveRogueMap()">返回</button>
            </div>
        </div>

        <div id="rogue-battle-scene" class="screen hidden">
            <div class="top-area">
                <div class="enemy-container">
                    <div id="rogue-enemy-intent" class="intent-icon">🗡️ 攻击 10</div>
                    <div id="rogue-enemy-sprite" class="enemy-avatar">👹</div>
                    <h2 id="rogue-enemy-name" style="margin:5px">哥布林赌徒</h2>
                    <div class="status-bar">
                        <div id="rogue-enemy-hp-bar" class="hp-fill" style="width: 100%;"></div>
                    </div>
                    <div style="font-size:0.9em">HP: <span id="rogue-enemy-hp">50</span>/<span id="rogue-enemy-max-hp">50</span></div>
                    <div id="rogue-enemy-buffs" style="color: var(--poison); font-size: 0.9em; height: 20px;"></div>
                </div>
                <div class="player-info">
                    <div style="font-size:0.9em">HP: <span id="player-hp">30</span>/<span id="player-max-hp">30</span></div>
                    <div style="font-size:0.9em">能量: <span id="player-energy">3</span></div>
                    <div style="font-size:0.9em">格挡: <span id="player-block">0</span></div>
                    <div style="font-size:0.9em">楼层: <span id="game-floor">1</span></div>
                    <div style="font-size:0.9em">金币: <span id="game-gold">50</span></div>
                    <div style="font-size:0.9em">钥匙: <span id="game-keys">0</span></div>
                </div>
            </div>

            <div id="rogue-game-log"></div>
            <button class="end-turn-btn" onclick="endRogueTurn()">结束回合</button>
            <button class="end-turn-btn" style="right: 180px; background: var(--accent);" onclick="openRogueMap()">查看地图</button>

            <div class="hand-area" id="rogue-player-hand">
                </div>
        </div>

        <div id="rogue-shop-screen" class="screen hidden">
            <h2>商店</h2>
            <p>金币: <span id="rogue-shop-gold">0</span></p>
            <div id="rogue-shop-items" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 30px 0;"></div>
            <button class="btn" onclick="leaveRogueShop()">离开商店</button>
        </div>

        <div id="rogue-event-screen" class="screen hidden">
            <h2 id="rogue-event-title">神秘事件</h2>
            <p id="rogue-event-description">你遇到了一个神秘的事件...</p>
            <div id="rogue-event-options" style="margin: 30px 0;"></div>
        </div>

        <div id="rogue-treasure-screen" class="screen hidden">
            <h2>宝藏房间</h2>
            <p>你发现了一个宝箱！</p>
            <div id="rogue-treasure-items" style="margin: 30px 0;"></div>
            <button class="btn" onclick="leaveRogueTreasure()">离开</button>
        </div>

        <div id="rogue-rest-screen" class="screen hidden">
            <h2>休息房间</h2>
            <p>你可以在这里休息恢复生命值。</p>
            <p>当前生命值: <span id="rogue-rest-hp">0</span>/<span id="rogue-rest-max-hp">0</span></p>
            <button class="btn" onclick="rogueRest()">休息 (恢复20点生命值)</button>
            <button class="btn" onclick="leaveRogueRest()">离开</button>
        </div>

        <div id="rogue-boss-screen" class="screen hidden">
            <h2>BOSS战</h2>
            <p>你遇到了最终BOSS！</p>
            <div id="rogue-boss-info" style="margin: 30px 0;"></div>
            <button class="btn btn-red" onclick="startRogueBossBattle()">挑战BOSS</button>
            <button class="btn" onclick="leaveRogueBoss()">逃跑 (失去所有金币)</button>
        </div>

        <div id="rogue-screen-reward" class="screen hidden">
            <h2>战斗胜利!</h2>
            <p>获得金币: <span id="rogue-reward-gold">20</span></p>
            <p>你的生命值恢复了 10 点</p>
            <div style="display: flex; gap: 20px; justify-content: center; margin-top: 30px;">
                <button class="btn" onclick="rogueReturnToMap()">返回房间</button>
                <button class="btn" onclick="rogueSkipFloor()">跳关</button>
            </div>
        </div>

        <div id="rogue-screen-gameover" class="screen hidden">
            <h1 style="color:red">你 输 了</h1>
            <p id="rogue-death-reason">死于贪婪</p>
            <button class="btn btn-red" onclick="restartRogueGame()">重新开始</button>
        </div>

        <div id="rogue-screen-win" class="screen hidden">
            <h1 style="color:gold">通 关 !</h1>
            <p>你成为了这场赌局的唯一赢家。</p>
            <button class="btn" onclick="restartRogueGame()">再来一局</button>
        </div>
    </div>

    <!-- 通知区域 -->
    <div id="notification-area"></div>

    <!-- 将所有JavaScript代码内联到这里 -->

    <script src="js/components/peerjs-multiplayer.js"></script>
    <script src="js/components/multiplayer-bindings.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
